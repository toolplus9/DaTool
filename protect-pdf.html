<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Protect PDF - DaTools</title>
  <meta name="description" content="Protect PDF with password online. Secure your PDF files with encryption instantly using DaTools. Free, fast, and easy.">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
  <style>
    body {
      background: linear-gradient(to right, #e0f7fa, #ffffff);
      font-family: 'Poppins', sans-serif;
    }
    .card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0px 10px 20px rgba(0,0,0,0.1);
    }
    .drop-zone {
      border: 2px dashed #38bdf8;
      transition: background 0.3s ease;
    }
    .drop-zone.dragover {
      background: #e0f2fe;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-6">

  <div class="card bg-white rounded-2xl shadow-xl p-8 max-w-lg w-full text-center">
    <h1 class="text-2xl font-bold text-sky-600 mb-4">üîê Protect PDF</h1>
    <p class="text-gray-600 mb-6">Secure your PDF file with a strong password. Fast and reliable.</p>
    
    <!-- Drag & Drop Zone -->
    <div id="dropZone" class="drop-zone rounded-xl p-6 cursor-pointer mb-4">
      <p class="text-gray-500">Drag & Drop your PDF here or click to upload</p>
      <input type="file" id="pdfInput" accept="application/pdf" class="hidden">
    </div>

    <!-- Password Inputs -->
    <input id="passwordInput" type="password" placeholder="Enter Password" 
      class="border border-gray-300 rounded-lg w-full p-2 mb-3 focus:ring-2 focus:ring-sky-400 outline-none">
    <input id="confirmPasswordInput" type="password" placeholder="Confirm Password" 
      class="border border-gray-300 rounded-lg w-full p-2 mb-4 focus:ring-2 focus:ring-sky-400 outline-none">

    <!-- Protect Button -->
    <button id="protectBtn" class="bg-sky-500 hover:bg-sky-600 text-white font-semibold px-6 py-2 rounded-lg shadow-md transition duration-300">
      Protect PDF
    </button>

    <!-- Loading Spinner -->
    <div id="loading" class="hidden mt-4 text-sky-500 font-medium animate-pulse">Protecting PDF... ‚è≥</div>

    <!-- Download Button -->
    <a id="downloadLink" href="#" download="protected.pdf" class="hidden mt-4 bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg shadow-md inline-block transition duration-300">
      Download Protected PDF
    </a>

    <!-- Error Message -->
    <p id="errorMsg" class="text-red-500 font-medium mt-3 hidden"></p>

    <!-- How to Use -->
    <div class="mt-6 text-left">
      <h2 class="text-lg font-semibold text-sky-600">üìñ How to Use:</h2>
      <ul class="list-disc list-inside text-gray-600 mt-2 text-sm">
        <li>Upload your PDF file.</li>
        <li>Enter a password and confirm it.</li>
        <li>Click "Protect PDF".</li>
        <li>Download your new secured PDF instantly.</li>
      </ul>
    </div>
  </div>

  <script>
    const dropZone = document.getElementById("dropZone");
    const pdfInput = document.getElementById("pdfInput");
    const protectBtn = document.getElementById("protectBtn");
    const passwordInput = document.getElementById("passwordInput");
    const confirmPasswordInput = document.getElementById("confirmPasswordInput");
    const downloadLink = document.getElementById("downloadLink");
    const errorMsg = document.getElementById("errorMsg");
    const loading = document.getElementById("loading");
    let pdfFile = null;

    // Drag and Drop events
    dropZone.addEventListener("click", () => pdfInput.click());
    dropZone.addEventListener("dragover", (e) => {
      e.preventDefault();
      dropZone.classList.add("dragover");
    });
    dropZone.addEventListener("dragleave", () => dropZone.classList.remove("dragover"));
    dropZone.addEventListener("drop", (e) => {
      e.preventDefault();
      dropZone.classList.remove("dragover");
      pdfFile = e.dataTransfer.files[0];
    });

    pdfInput.addEventListener("change", (e) => {
      pdfFile = e.target.files[0];
    });

    // Protect PDF
    protectBtn.addEventListener("click", async () => {
      if (!pdfFile) {
        errorMsg.textContent = "‚ö†Ô∏è Please upload a PDF file.";
        errorMsg.classList.remove("hidden");
        return;
      }
      if (!passwordInput.value || !confirmPasswordInput.value) {
        errorMsg.textContent = "‚ö†Ô∏è Please enter and confirm the password.";
        errorMsg.classList.remove("hidden");
        return;
      }
      if (passwordInput.value !== confirmPasswordInput.value) {
        errorMsg.textContent = "‚ö†Ô∏è Passwords do not match.";
        errorMsg.classList.remove("hidden");
        return;
      }

      errorMsg.classList.add("hidden");
      loading.classList.remove("hidden");

      try {
        const reader = new FileReader();
        reader.onload = async function(e) {
          try {
            const pdfBytes = new Uint8Array(e.target.result);
            const pdfDoc = await PDFLib.PDFDocument.load(pdfBytes);

            // Set password protection
            pdfDoc.encrypt({
              ownerPassword: passwordInput.value,
              userPassword: passwordInput.value,
              permissions: {
                printing: 'highResolution',
                modifying: false,
                copying: false,
                annotating: false,
                fillingForms: false,
                contentAccessibility: false,
                documentAssembly: false,
              },
            });

            const protectedPdfBytes = await pdfDoc.save();
            const blob = new Blob([protectedPdfBytes], { type: "application/pdf" });
            const url = URL.createObjectURL(blob);

            downloadLink.href = url;
            downloadLink.classList.remove("hidden");
            errorMsg.classList.add("hidden");
          } catch (err) {
            errorMsg.textContent = "‚ùå Failed to protect PDF.";
            errorMsg.classList.remove("hidden");
          } finally {
            loading.classList.add("hidden");
          }
        };
        reader.readAsArrayBuffer(pdfFile);
      } catch (err) {
        errorMsg.textContent = "‚ùå Something went wrong. Please try again.";
        errorMsg.classList.remove("hidden");
        loading.classList.add("hidden");
      }
    });
  </script>

</body>
</html>
