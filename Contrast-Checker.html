<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Contrast Checker — DaTools</title>
<meta name="description" content="Contrast checker: test color contrast against WCAG AA/AAA, preview on sample text and images, color pickers, suggestions, and export reports. DaTools theme." />
<meta name="keywords" content="contrast checker, accessibility, WCAG, color contrast, DaTools" />
<link rel="icon" href="data:;base64,iVBORw0KGgo=" />
<style>
  :root{--sky-50:#eaf6ff;--sky-300:#7fd0ff;--sky-500:#2aa7e0;--dark:#0b2030;--muted:#6b7b86;--glass:rgba(255,255,255,0.7);--card-shadow:0 8px 30px rgba(10,35,60,0.08);font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial}
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,var(--sky-50),#fff 40%);color:var(--dark);min-height:100vh;display:flex;align-items:flex-start;justify-content:center;padding:28px}
  .container{width:1100px;max-width:100%}
  header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--sky-300),var(--sky-500));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:18px;box-shadow:0 12px 30px rgba(42,167,224,0.16);animation:floaty 6s ease-in-out infinite}
  h1{margin:0;font-size:18px}
  p.lead{margin:0;color:var(--muted);font-size:13px}
  .card{background:rgba(255,255,255,0.95);padding:16px;border-radius:12px;box-shadow:var(--card-shadow)}
  main.grid{display:grid;grid-template-columns:1fr 420px;gap:18px}
  .controls{display:flex;flex-direction:column;gap:12px}
  label{font-size:13px;color:var(--muted)}
  .row{display:flex;gap:8px;align-items:center}
  input[type=color]{width:56px;height:40px;border-radius:8px;border:none;cursor:pointer}
  .css-code{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;background:rgba(11,32,48,0.03);padding:8px;border-radius:8px;font-size:13px}
  button.btn{background:linear-gradient(180deg,var(--sky-300),var(--sky-500));color:#fff;border:none;padding:10px 12px;border-radius:10px;cursor:pointer;font-weight:600;box-shadow:0 8px 18px rgba(42,167,224,0.14);transition:all .18s}
  button.btn.ghost{background:transparent;color:var(--dark);border:1px solid rgba(42,167,224,0.12)}
  .preview{border-radius:10px;overflow:hidden;min-height:220px;padding:18px;display:flex;flex-direction:column;gap:12px;justify-content:center;align-items:flex-start}
  .sample{padding:18px;border-radius:8px;width:100%;box-shadow:0 6px 18px rgba(10,35,60,0.04)}
  .muted{color:var(--muted)}
  .results{display:flex;gap:8px;flex-wrap:wrap}
  .result-pill{padding:8px 10px;border-radius:10px;font-weight:700}
  .ok{background:#e6fff4;color:#02592b}
  .warn{background:#fff8e6;color:#624100}
  .fail{background:#ffecec;color:#7a1111}
  .legend{display:flex;gap:8px;align-items:center}
  .legend div{width:16px;height:16px;border-radius:4px}
  .controls .tools{display:flex;gap:8px;flex-wrap:wrap}
  .kb{font-size:12px;color:var(--muted)}
  .small{font-size:12px;color:var(--muted)}
  .suggestions{background:rgba(11,32,48,0.03);padding:10px;border-radius:8px}
  @media(max-width:980px){main.grid{grid-template-columns:1fr} .preview{min-height:160px}}
  @keyframes floaty{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}
  /* subtle button hover */
  button.btn:hover{transform:translateY(-3px)}
</style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">DT</div>
        <div>
          <h1>DaTools — Contrast Checker</h1>
          <p class="lead">Test color contrast for accessibility (WCAG AA/AAA), live preview on text & images, get suggestions and export reports.</p>
        </div>
      </div>
      <div class="muted">Made by <strong>Syed Afnan SAV</strong> • toolplus9@gmail.com</div>
    </header>

    <div class="card">
      <main class="grid">
        <section class="controls">

          <div>
            <label>Foreground color (text / element)</label>
            <div class="row"><input id="fgColor" type="color" value="#0b2030"/><input id="fgHex" class="css-code" value="#0b2030"/></div>
          </div>

          <div>
            <label>Background color</label>
            <div class="row"><input id="bgColor" type="color" value="#ffffff"/><input id="bgHex" class="css-code" value="#ffffff"/></div>
          </div>

          <div>
            <label>Text size & weight (for WCAG)</label>
            <div class="row">
              <select id="textSize" class="css-code"><option value="12">12px (small)</option><option value="14">14px</option><option value="16" selected>16px (normal)</option><option value="18">18px</option><option value="24">24px (large)</option><option value="32">32px (x-large)</option></select>
              <select id="textWeight" class="css-code"><option value="400">Normal</option><option value="600" selected>Bold (600)</option><option value="700">Bolder</option></select>
              <label class="small">Use large text threshold when ≥18px and weight bold (≥600).</label>
            </div>
          </div>

          <div>
            <label>Sample content / label</label>
            <input id="sampleText" class="css-code" value="The quick brown fox jumps over the lazy dog"/>
          </div>

          <div>
            <label>Upload background image (optional)</label>
            <input id="bgImageFile" type="file" accept="image/*" class="css-code"/>
            <label class="kb"><input id="imageOverlay" type="checkbox"/> Use image as background for preview</label>
          </div>

          <div class="tools">
            <button class="btn" id="checkBtn">Check Contrast</button>
            <button class="btn ghost" id="swapBtn">Swap Colors</button>
            <button class="btn ghost" id="randBtn">Random Colors</button>
            <button class="btn ghost" id="suggestBtn">Suggest Accessible Color</button>
            <button class="btn ghost" id="exportBtn">Download Report</button>
          </div>

          <div style="margin-top:8px">
            <label>Results</label>
            <div class="results" id="results">
              <!-- pills inserted here -->
            </div>
          </div>

          <div style="margin-top:8px">
            <label>Suggestions</label>
            <div class="suggestions" id="suggestions">No suggestions yet — click <strong>Check Contrast</strong>.</div>
          </div>

        </section>

        <aside>
          <div class="preview card">
            <div style="display:flex;justify-content:space-between;align-items:center;width:100%">
              <div class="small-muted">Live preview</div>
              <div class="legend">
                <div style="background:var(--sky-500)"></div><div class="small">DaTools</div>
              </div>
            </div>

            <div id="sampleWrapper" class="sample" style="margin-top:12px;width:100%">
              <div id="sampleTextEl" style="font-size:16px;font-weight:600;color:#0b2030;">The quick brown fox jumps over the lazy dog</div>
              <div id="sampleSub" class="small" style="margin-top:8px;color:var(--muted)">This is how the text will look on the selected background.</div>
            </div>

            <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
              <div class="css-code" id="computedRatio">Contrast ratio: —</div>
              <div class="css-code" id="wcagPass">WCAG: —</div>
            </div>

          </div>

          <div style="margin-top:12px">
            <label>Accessibility notes</label>
            <div class="css-code" id="notes">Run a check to see detailed notes and tips.</div>
          </div>
        </aside>

      </main>
    </div>
  </div>

<script>
  // helpers
  const $ = id => document.getElementById(id);
  function clamp(v,min,max){return Math.max(min,Math.min(max,v));}

  // elements
  const fgColor = $('fgColor'), bgColor = $('bgColor'), fgHex = $('fgHex'), bgHex = $('bgHex');
  const sampleText = $('sampleText'), sampleTextEl = $('sampleTextEl'), sampleWrapper = $('sampleWrapper');
  const textSize = $('textSize'), textWeight = $('textWeight');
  const checkBtn = $('checkBtn'), swapBtn=$('swapBtn'), randBtn=$('randBtn'), suggestBtn=$('suggestBtn'), exportBtn=$('exportBtn');
  const results = $('results'), suggestions = $('suggestions'), computedRatio = $('computedRatio'), wcagPass = $('wcagPass'), notes = $('notes');
  const bgImageFile = $('bgImageFile'), imageOverlay = $('imageOverlay');

  // sync hex inputs
  function toHex(v){ if(!v) return '#000000'; if(v.startsWith('#')) return v; return '#'+v.toString(16).padStart(6,'0'); }
  fgColor.addEventListener('input', e=>{ fgHex.value = e.target.value; applyColors(); });
  bgColor.addEventListener('input', e=>{ bgHex.value = e.target.value; applyColors(); });
  fgHex.addEventListener('input', e=>{ const v=e.target.value.trim(); if(/^#?[0-9A-Fa-f]{6}$/.test(v)) fgColor.value = v.startsWith('#')?v:'#'+v; applyColors(); });
  bgHex.addEventListener('input', e=>{ const v=e.target.value.trim(); if(/^#?[0-9A-Fa-f]{6}$/.test(v)) bgColor.value = v.startsWith('#')?v:'#'+v; applyColors(); });

  // apply to preview
  function applyColors(){ sampleTextEl.style.color = fgColor.value; sampleWrapper.style.background = bgColor.value; sampleTextEl.style.fontSize = textSize.value+'px'; sampleTextEl.style.fontWeight = textWeight.value; sampleTextEl.textContent = sampleText.value; }

  // contrast calculation (WCAG) — return ratio float
  function luminance(r,g,b){ let RsRGB=r/255, GsRGB=g/255, BsRGB=b/255; [RsRGB,GsRGB,BsRGB] = [RsRGB,GsRGB,BsRGB].map(c=>{ return c<=0.03928?c/12.92:Math.pow((c+0.055)/1.055,2.4); }); return 0.2126*RsRGB + 0.7152*GsRGB + 0.0722*BsRGB; }
  function hexToRgb(hex){ if(hex.startsWith('#')) hex=hex.slice(1); return {r:parseInt(hex.slice(0,2),16), g:parseInt(hex.slice(2,4),16), b:parseInt(hex.slice(4,6),16)}; }
  function contrastRatio(hex1, hex2){ const c1=hexToRgb(hex1), c2=hexToRgb(hex2); const L1 = luminance(c1.r,c1.g,c1.b); const L2 = luminance(c2.r,c2.g,c2.b); const lighter = Math.max(L1,L2), darker = Math.min(L1,L2); return (lighter+0.05)/(darker+0.05); }

  // check function
  function checkContrast(){ const fg=fgColor.value, bg=bgColor.value; const ratio = contrastRatio(fg,bg); const rounded = Math.round(ratio*100)/100; computedRatio.textContent = 'Contrast ratio: '+rounded+':1';
    // wcag thresholds
    const fontPx = parseFloat(textSize.value); const weight = parseInt(textWeight.value);
    const isLarge = (fontPx>=18 && weight>=400) || (fontPx>=14 && weight>=600); // simplified rule
    const AA_level = isLarge?3.0:4.5; const AAA_level = isLarge?4.5:7.0; const aaPass = ratio>=AA_level; const aaaPass = ratio>=AAA_level;
    wcagPass.textContent = `WCAG AA: ${aaPass?'PASS':'FAIL'} | WCAG AAA: ${aaaPass?'PASS':'FAIL'}`;

    results.innerHTML='';
    const pill1 = document.createElement('div'); pill1.className='result-pill '+(aaPass?'ok':'fail'); pill1.textContent = `AA ${isLarge?'(Large)':''}: ${aaPass? 'PASS':'FAIL'}`;
    const pill2 = document.createElement('div'); pill2.className='result-pill '+(aaaPass?'ok':'fail'); pill2.textContent = `AAA ${isLarge?'(Large)':''}: ${aaaPass? 'PASS':'FAIL'}`;
    results.appendChild(pill1); results.appendChild(pill2);

    // suggestions
    const suggestionList = [];
    if(!aaPass){ // try suggest darker/lighter foreground options
      const suggestion = findNearestAccessibleColor(fg,bg,AA_level);
      if(suggestion) suggestionList.push({title:'Suggested text color', color:suggestion});
    }
    if(suggestionList.length===0) suggestions.innerHTML = '<strong>No change needed</strong> — colors already pass accessibility for selected text size.';
    else{
      suggestions.innerHTML = '';
      suggestionList.forEach(s=>{
        const d = document.createElement('div'); d.style.display='flex'; d.style.alignItems='center'; d.style.gap='8px'; d.style.marginBottom='6px';
        const sw = document.createElement('div'); sw.style.width='44px'; sw.style.height='30px'; sw.style.borderRadius='6px'; sw.style.background=s.color; sw.style.border='1px solid rgba(0,0,0,0.06)';
        const t = document.createElement('div'); t.innerHTML = `<strong>${s.title}</strong><div class=\"small\">${s.color}</div>`;
        const btn = document.createElement('button'); btn.className='btn ghost'; btn.textContent='Apply'; btn.addEventListener('click', ()=>{ fgColor.value = s.color; fgHex.value = s.color; applyColors(); checkContrast(); });
        d.appendChild(sw); d.appendChild(t); d.appendChild(btn); suggestions.appendChild(d);
      });
    }

    // notes
    notes.textContent = `Details: ratio ${rounded.toFixed(2)}. AA threshold for this text is ${AA_level}. AAA threshold is ${AAA_level}. ${aaPass? 'AA passed.' : 'AA failed; consider using suggested color.'}`;
  }

  // find nearest accessible color by darkening or lightening FG until passes
  function findNearestAccessibleColor(fgHex, bgHex, threshold){ const steps=100; const fg = hexToRgb(fgHex); const bg = hexToRgb(bgHex);
    // try lighten and darken paths
    for(let i=1;i<=steps;i++){
      // darken fg
      const factor = i/steps;
      const dark = {r:Math.round(fg.r*(1-factor)), g:Math.round(fg.g*(1-factor)), b:Math.round(fg.b*(1-factor))}; const darkHex = rgbToHex(dark.r,dark.g,dark.b);
      if(contrastRatio(darkHex,bgHex) >= threshold) return darkHex;
      // lighten
      const light = {r:Math.round(fg.r + (255-fg.r)*factor), g:Math.round(fg.g + (255-fg.g)*factor), b:Math.round(fg.b + (255-fg.b)*factor)}; const lightHex = rgbToHex(light.r,light.g,light.b);
      if(contrastRatio(lightHex,bgHex) >= threshold) return lightHex;
    }
    return null;
  }

  function rgbToHex(r,g,b){ return '#'+[r,g,b].map(x=>x.toString(16).padStart(2,'0')).join(''); }

  // swap and random
  swapBtn.addEventListener('click', ()=>{ const a=fgColor.value; const b=bgColor.value; fgColor.value=b; bgColor.value=a; fgHex.value=b; bgHex.value=a; applyColors(); });
  randBtn.addEventListener('click', ()=>{ const a=randomColor(); const b=randomColor(); fgColor.value=a; bgColor.value=b; fgHex.value=a; bgHex.value=b; applyColors(); });

  suggestBtn.addEventListener('click', ()=>{ const target = parseFloat(textSize.value); // re-run check which will produce suggestions
    checkContrast(); });

  checkBtn.addEventListener('click', checkContrast);

  // export report as text file
  exportBtn.addEventListener('click', ()=>{
    const fg=fgColor.value, bg=bgColor.value; const ratio = contrastRatio(fg,bg); const fontPx=textSize.value; const weight=textWeight.value;
    const txt = `DaTools Contrast Report\nDate: ${new Date().toLocaleString()}\nForeground: ${fg}\nBackground: ${bg}\nText size: ${fontPx}px, weight: ${weight}\nContrast ratio: ${Math.round(ratio*100)/100}:1\n`;
    const blob = new Blob([txt],{type:'text/plain'}); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='contrast-report.txt'; a.click(); URL.revokeObjectURL(url);
  });

  // image background handling for preview
  bgImageFile.addEventListener('change', e=>{ const f = e.target.files && e.target.files[0]; if(!f) return; const reader = new FileReader(); reader.onload = ev=>{ sampleWrapper.style.background = `url('${ev.target.result}') center/cover`; if(!imageOverlay.checked){ sampleTextEl.style.color = fgColor.value; } else { /* overlay still uses bgColor on top if needed */ } }; reader.readAsDataURL(f); });

  // random color generator
  function randomColor(){ return '#'+Math.floor(Math.random()*16777215).toString(16).padStart(6,'0'); }

  // initial apply
  applyColors();

  // keyboard accessibility: Enter on hex input triggers apply
  [fgHex,bgHex,sampleText].forEach(el=>el.addEventListener('keydown', e=>{ if(e.key==='Enter') applyColors(); }));

</script>
</body>
</html>
